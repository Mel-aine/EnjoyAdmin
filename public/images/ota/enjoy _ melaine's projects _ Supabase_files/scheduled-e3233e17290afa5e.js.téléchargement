try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8b108e74-cdff-48b7-9b48-d5bd7307f6f1",e._sentryDebugIdIdentifier="sentry-dbid-8b108e74-cdff-48b7-9b48-d5bd7307f6f1")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74307],{1374:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},3146:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var s=a(80263),r=a(20033),i=a(60793);let n=()=>(0,s.jsxs)(r.Fc,{variant:"default","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"BackupsStorageAlert","data-sentry-source-file":"BackupsStorageAlert.tsx",children:[(0,s.jsx)(i.id,{"data-sentry-element":"WarningIcon","data-sentry-source-file":"BackupsStorageAlert.tsx"}),(0,s.jsx)(r.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"BackupsStorageAlert.tsx",children:"Database backups do not include objects stored via the Storage API, as the database only includes metadata about these objects. Restoring an old backup does not restore objects that have been deleted since then."})]})},11612:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var s=a(80263),r=a(72112),i=a(80356),n=a(22891),l=a(53434),d=a.n(l),c=a(56718),o=a(80814),u=a(53239),y=a(73969),p=a(64778),h=a(8344),x=a(80210),m=a(24523);async function k(e){let{ref:t,backup:a}=e;if(a.isPhysicalBackup){let{data:e,error:s}=await (0,m.bE)("/platform/database/{ref}/backups/restore-physical",{params:{path:{ref:t}},body:{id:a.id,recovery_time_target:a.inserted_at}});if(s)throw s;return e}let{data:s,error:r}=await (0,m.bE)("/platform/database/{ref}/backups/restore",{params:{path:{ref:t}},body:{id:a.id}});return r&&(0,m.H4)(r),s}let f=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,x.n)({mutationFn:e=>k(e),async onSuccess(t,a,s){await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?y.oR.error("Failed to restore from backup: ".concat(e.message)):t(e,a,s)},...a})};var b=a(86936),g=a(37115),j=a(9620),v=a(85039),A=a(68421),w=a(29948),P=a(23729),M=a(10723),_=a(24741),B=a(80090),T=a(21650),I=a(30404),D=a(88044);let E=e=>{let{index:t,isHealthy:a,backup:i,onSelectBackup:l}=e,{ref:d}=(0,n.g)(),{can:c}=(0,B.Qp)(r.aG.INFRA_EXECUTE,"queue_job.restore.prepare"),{mutate:o,isPending:u}=(0,_.Z)({onSuccess:e=>{let{fileUrl:t}=e,a=document.createElement("a");a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}});return(0,s.jsxs)("div",{className:"flex h-12 items-center justify-between px-6 ".concat(t?"border-t border-default":""),"data-sentry-component":"BackupItem","data-sentry-source-file":"BackupItem.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(D.T,{displayAs:"utc",utcTimestamp:i.inserted_at,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"text-left !text-sm font-mono tracking-tight","data-sentry-element":"TimestampInfo","data-sentry-source-file":"BackupItem.tsx"}),(0,s.jsxs)(I.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"BackupItem.tsx",children:[(0,s.jsx)(I.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"BackupItem.tsx",children:(0,s.jsx)(T.E,{variant:"default","data-sentry-element":"Badge","data-sentry-source-file":"BackupItem.tsx",children:i.isPhysicalBackup?"Physical":"Logical"})}),(0,s.jsxs)(I.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"BackupItem.tsx",children:["Learn more about backup types"," ",(0,s.jsx)(M.g,{href:"https://supabase.com/blog/postgresql-physical-logical-backups","data-sentry-element":"InlineLink","data-sentry-source-file":"BackupItem.tsx",children:"here"})]})]})]}),(0,s.jsx)("div",{children:(e=>"COMPLETED"===e.status?(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(P.G,{type:"default",disabled:!a||!c,onClick:l,tooltip:{content:{side:"bottom",text:a?c?void 0:"You need additional permissions to trigger a restore":"Cannot be restored as project is not active"}},children:"Restore"}),(0,s.jsx)(P.G,{type:"default",icon:(0,s.jsx)(w.A,{}),loading:u,disabled:!c||u||e.isPhysicalBackup,onClick:()=>{if(!d)return console.error("Project ref is required");o({ref:d,backup:e})},tooltip:{content:{side:"bottom",className:e.isPhysicalBackup?"w-64":"",text:e.isPhysicalBackup?(0,s.jsxs)(s.Fragment,{children:["Physical backups cannot be downloaded through the dashboard. You can still download it via pgdump by following our guide"," ",(0,s.jsx)(M.g,{href:"".concat(v.aq,"/guides/troubleshooting/download-logical-backups"),children:"here"}),"."]}):c?void 0:"You need additional permissions to download backups"}},children:"Download"})]}):(0,s.jsx)(T.E,{variant:"warning","data-sentry-element":"Badge","data-sentry-component":"generateSideButtons","data-sentry-source-file":"BackupItem.tsx",children:"Backup In Progress..."}))(i)})]})};var q=a(28068),C=a(3146);let S=()=>{var e,t;let a=(0,o.useRouter)(),{ref:r}=(0,n.g)(),[i,l]=(0,u.useState)(),{setProjectStatus:x}=(0,g.l1)(),{data:m}=(0,j.YA)(),k=(null==m?void 0:m.status)===v.BU.ACTIVE_HEALTHY,{data:w}=(0,b.h)({projectRef:r}),{mutate:P,isPending:M,isSuccess:_}=f({onSuccess:()=>{r&&setTimeout(()=>{x({ref:r,status:v.BU.RESTORING}),y.oR.success("Restoring database back to ".concat(d()(null==i?void 0:i.inserted_at).format("DD MMM YYYY HH:mm:ss"))),a.push("/project/".concat(r))},3e3)}}),B=null!=(e=null==w?void 0:w.tierKey)?e:"",T=(null!=(t=null==w?void 0:w.backups)?t:[]).sort((e,t)=>new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()),I=null==w?void 0:w.pitr_enabled;return"FREE"===B?(0,s.jsx)(h.A,{addon:"pitr",icon:(0,s.jsx)(c.A,{size:20}),primaryText:"Free Plan does not include project backups.",secondaryText:"Upgrade to the Pro Plan for up to 7 days of scheduled backups.",source:"backups"}):I?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-6",children:0===T.length&&"FREE"!==B?(0,s.jsx)(q.V,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.$,{}),(0,s.jsx)(p.A,{children:null==T?void 0:T.map((e,t)=>(0,s.jsx)(E,{backup:e,index:t,isHealthy:k,onSelectBackup:()=>l(e)},e.id))})]})}),(0,s.jsx)(A.A,{size:"medium",confirmLabel:"Confirm restore",confirmLabelLoading:"Restoring",visible:void 0!==i,title:"Confirm to restore from backup",alert:{base:{variant:"warning"},title:"Your project will be offline while the restore is in progress",description:"It is advised to upgrade at a time when there will be minimal impact for your application."},loading:M||_,onCancel:()=>l(void 0),onConfirm:()=>void 0===r?console.error("Project ref required"):void 0===i?console.error("Backup required"):void P({ref:r,backup:i}),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"BackupsList.tsx",children:(0,s.jsxs)("p",{className:"text-sm",children:["Are you sure you want to restore from"," ",d()(null==i?void 0:i.inserted_at).format("DD MMM YYYY"),"? This will destroy any new data written since this backup was made."]})})]})};var N=a(61431),R=a(68296),Y=a(57393),H=a(44168),L=a(41273),F=a(57125),z=a(39624),G=a(53931),O=a(44725),V=a(45218),Z=a(30688),U=a(14354);let K=()=>{let{ref:e}=(0,n.g)(),{data:t,error:a,isLoading:l,isError:d,isSuccess:c}=(0,b.h)({projectRef:e}),o=(0,j.CG)(),u=null==t?void 0:t.pitr_enabled,{can:y,isSuccess:p}=(0,B.Qp)(r.aG.READ,"back_ups");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(Z.zY,{"data-sentry-element":"PageHeader","data-sentry-source-file":"scheduled.tsx",children:[(0,s.jsx)(Z.Ys,{"data-sentry-element":"PageHeaderMeta","data-sentry-source-file":"scheduled.tsx",children:(0,s.jsx)(Z.tq,{"data-sentry-element":"PageHeaderSummary","data-sentry-source-file":"scheduled.tsx",children:(0,s.jsx)(Z.RR,{"data-sentry-element":"PageHeaderTitle","data-sentry-source-file":"scheduled.tsx",children:"Database Backups"})})}),(0,s.jsx)(Z.zR,{"data-sentry-element":"PageHeaderNavigationTabs","data-sentry-source-file":"scheduled.tsx",children:(0,s.jsx)(N.A,{active:"scheduled","data-sentry-element":"DatabaseBackupsNav","data-sentry-source-file":"scheduled.tsx"})})]}),(0,s.jsx)(V.L,{"data-sentry-element":"PageContainer","data-sentry-source-file":"scheduled.tsx",children:(0,s.jsx)(U.d8,{"data-sentry-element":"PageSection","data-sentry-source-file":"scheduled.tsx",children:(0,s.jsx)(U.KP,{"data-sentry-element":"PageSectionContent","data-sentry-source-file":"scheduled.tsx",children:o?(0,s.jsx)(O.Z,{type:"default",title:"Database backups are not available for OrioleDB",description:"OrioleDB is currently in public alpha and projects created are strictly ephemeral with no database backups",children:(0,s.jsx)(L.A,{abbrev:!1,className:"mt-2",href:"".concat(v.aq)})}):(0,s.jsxs)("div",{className:"flex flex-col gap-y-4",children:[l&&(0,s.jsx)(G.yV,{}),d&&(0,s.jsx)(H.A,{error:a,subject:"Failed to retrieve scheduled backups"}),c&&(0,s.jsxs)(s.Fragment,{children:[!u&&(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Projects are backed up daily around midnight of your project's region and can be restored at any time."}),u&&(0,s.jsx)(F.A,{hideCollapse:!0,defaultVisibility:!0,icon:(0,s.jsx)(i.A,{strokeWidth:2}),title:"Point-In-Time-Recovery (PITR) enabled",description:(0,s.jsxs)("div",{children:["Your project uses PITR and full daily backups are no longer taken. They're not needed, as PITR supports a superset of functionality, in terms of the granular recovery that can be performed."," ",(0,s.jsx)("a",{className:"text-brand transition-colors hover:text-brand-600",href:"".concat(v.aq,"/guides/platform/backups"),children:"Learn more"})]})}),p&&!y?(0,s.jsx)(z.A,{resourceText:"view scheduled backups"}):(0,s.jsx)(S,{})]})]})})})})]})};K.getLayout=e=>(0,s.jsx)(Y.A,{children:(0,s.jsx)(R.A,{title:"Database",children:e})});let X=K},13450:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("DatabaseBackup",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 12a9 3 0 0 0 5 2.69",key:"1ui2ym"}],["path",{d:"M21 9.3V5",key:"6k6cib"}],["path",{d:"M3 5v14a9 3 0 0 0 6.47 2.88",key:"i62tjy"}],["path",{d:"M12 12v4h4",key:"1bxaet"}],["path",{d:"M13 20a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L12 16",key:"1f4ei9"}]])},13655:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]])},25822:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},29948:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},31626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},39859:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/backups/scheduled",function(){return a(11612)}])},53407:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]])},54831:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},66959:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("DatabaseZap",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 15 21.84",key:"14ibmq"}],["path",{d:"M21 5V8",key:"1marbg"}],["path",{d:"M21 12L18 17H22L19 22",key:"zafso"}],["path",{d:"M3 12A9 3 0 0 0 14.59 14.87",key:"1y4wr8"}]])},69988:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},74195:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]])},74310:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},77444:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},86936:(e,t,a)=>{"use strict";a.d(t,{h:()=>d});var s=a(67850),r=a(24523),i=a(9620),n=a(32510);async function l(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:s,error:i}=await (0,r.Jt)("/platform/database/{ref}/backups",{params:{path:{ref:a}},signal:t});return i&&(0,r.H4)(i),s}let d=function(e){let{projectRef:t}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=(0,i.CG)();return(0,s.I)({queryKey:n.c.backups(t),queryFn:e=>{let{signal:a}=e;return l({projectRef:t},a)},enabled:a&&!d&&void 0!==t,...r})}},98103:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]])},99940:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},e=>{e.O(0,[92376,60858,15599,16110,76391,36538,32421,76984,72391,35035,40545,596,57393,75187,29471,12182,75713,90636,46593,38792],()=>e(e.s=39859)),_N_E=e.O()}]);